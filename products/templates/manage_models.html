<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Modelos</title>
</head>

<body>
    {% extends 'base.html' %}

    {% block content %}
    <h2 class="text-center">Gestionar Modelos</h2>

    <!-- Botón para abrir el modal de agregar -->
    <button class="btn btn-success mb-3" data-bs-toggle="modal" data-bs-target="#addModelModal">
        <i class="fas fa-plus"></i> Agregar Modelo
    </button>

    <table class="table table-striped table-bordered">
        <thead class="table-dark">
            <tr>
                <th>N° Modelo</th>
                <th>Nombre</th>
                <th>Color</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for model in page_obj %}
            <tr>
                <td>{{ model.id }}</td>
                <td>{{ model.description }}</td>
                <td>{{ model.color }}</td>
                <td class="text-center">
                    <!-- Botón para el modal de editar -->
                    <button data-bs-toggle="modal" data-bs-target="#editModelModal{{ model.id }}"
                        class="btn btn-primary">
                        <i class="fas fa-edit"></i>
                    </button>

                    <!-- Botón para el modal de eliminar -->
                    <button data-bs-toggle="modal" data-bs-target="#deleteModelModal{{ model.id }}"
                        class="btn btn-danger">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </td>
            </tr>

            <!-- Modal de agregar -->
            <div class="modal fade" id="addModelModal" tabindex="-1" aria-labelledby="addModelModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <form method="post" action="{% url 'add_model' %}">
                            {% csrf_token %}
                            <div class="modal-header bg-success text-white">
                                <h5 class="modal-title" id="addModelModalLabel">Agregar Modelo</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="mb-3">
                                    <label for="description" class="form-label">Descripción:</label>
                                    <input type="text" name="description" class="form-control" placeholder="Descripción"
                                        required>
                                </div>
                                <div class="mb-3">
                                    <label for="color" class="form-label">Color:</label>
                                    <input type="text" name="color" class="form-control" placeholder="Color" required>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                <button type="submit" class="btn btn-success">Guardar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Modal de editar -->
            <div class="modal fade" id="editModelModal{{ model.id }}" tabindex="-1"
                aria-labelledby="editModelModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <form method="post" action="{% url 'edit_model' model.id %}">
                            {% csrf_token %}
                            <div class="modal-header bg-primary text-white">
                                <h5 class=" modal-title" id="editModelModalLabel">Editar Modelo</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="mb-3">
                                    <label for="description" class="form-label">Descripción:</label>
                                    <input type="text" name="description" value="{{ model.description }}"
                                        class="form-control" required>
                                </div>
                                <div class="mb-3">
                                    <label for="color" class="form-label">Color:</label>
                                    <input type="text" name="color" value="{{ model.color }}" class="form-control"
                                        required>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Modal de eliminar -->
            <div class="modal fade" id="deleteModelModal{{ model.id }}" tabindex="-1"
                aria-labelledby="deleteModelModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <form method="post" action="{% url 'delete_model' model.id %}">
                            {% csrf_token %}
                            <div class="modal-header bg-danger text-white">
                                <h5 class="modal-title" id="deleteModelModalLabel">Eliminar Modelo</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                ¿Estás seguro de que deseas eliminar este modelo?
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary"
                                    data-bs-dismiss="modal">Cancelar</button>
                                <button type="submit" class="btn btn-danger">Eliminar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            {% endfor %}
        </tbody>
    </table>

    <!-- Paginador -->
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            {% if page_obj.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page=1" aria-label="First">
                    <span aria-hidden="true">&laquo;&laquo;</span>
                </a>
            </li>
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            {% endif %}

            {% for num in page_obj.paginator.page_range %}
            {% if page_obj.number == num %}
            <li class="page-item active"><a class="page-link">{{ num }}</a></li>
            {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %} <li class="page-item"><a
                    class="page-link" href="?page={{ num }}">{{ num }}</a></li>
                {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}" aria-label="Last">
                        <span aria-hidden="true">&raquo;&raquo;</span>
                    </a>
                </li>
                {% endif %}
        </ul>
    </nav>

    <style>
        h2 {
            color: rgb(61, 61, 156);
        }

        h2:hover {
            color: rgb(27, 84, 206);
        }
    </style>

    {% endblock %}
</body>

</html>